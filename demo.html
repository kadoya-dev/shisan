<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>見積もり試算ツール</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; margin: 16px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; max-width: 720px; margin: 0 auto; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    label { font-size: 14px; color: #333; display: block; margin-bottom: 6px; }
    input, select { width: 100%; padding: 10px 12px; border: 1px solid #ccc; border-radius: 10px; font-size: 16px; }
    .row { margin-top: 12px; }
    .result { margin-top: 16px; padding: 12px; border-radius: 12px; background: #f7f7f7; }
    .result .big { font-size: 22px; font-weight: 700; }
    .muted { color: #666; font-size: 13px; margin-top: 4px; }
    button { margin-top: 16px; width: 100%; padding: 12px; font-size: 16px; border: 0; border-radius: 12px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="card">
    <h2 style="margin:0 0 12px;">見積もり試算</h2>

    <div class="grid">
      <div>
        <label>商品代（円）</label>
        <input id="itemPrice" type="number" min="0" step="1" placeholder="例: 12000" />
      </div>
      <div>
        <label>数量</label>
        <input id="qty" type="number" min="1" step="1" value="1" />
      </div>

      <div>
        <label>送料（円）</label>
        <input id="shipping" type="number" min="0" step="1" placeholder="例: 1800" />
      </div>
      <div>
        <label>手数料率</label>
        <select id="feeRate">
          <option value="0.05">5%</option>
          <option value="0.08" selected>8%</option>
          <option value="0.10">10%</option>
        </select>
      </div>

      <div>
        <label>保険料（円）</label>
        <input id="insurance" type="number" min="0" step="1" value="0" />
      </div>
      <div>
        <label>割引（円）</label>
        <input id="discount" type="number" min="0" step="1" value="0" />
      </div>
    </div>

    <button id="calcBtn">計算する</button>

    <div class="result" id="resultBox" style="display:none;">
      <div class="big" id="total"></div>
      <div class="muted" id="breakdown"></div>
    </div>

    <div class="muted">
      ※このサンプルの計算式：<br>
      小計 = 商品代×数量 + 送料 + 保険料<br>
      手数料 = 小計×手数料率<br>
      合計 = 小計 + 手数料 − 割引
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    function n(v) {
      const x = Number(v);
      return Number.isFinite(x) ? x : 0;
    }

    function yen(v) {
      return new Intl.NumberFormat("ja-JP", { style: "currency", currency: "JPY" }).format(v);
    }

    function calc() {
      const itemPrice = n($("itemPrice").value);
      const qty = Math.max(1, Math.floor(n($("qty").value)));
      const shipping = n($("shipping").value);
      const insurance = n($("insurance").value);
      const discount = n($("discount").value);
      const feeRate = n($("feeRate").value);

      const subtotal = itemPrice * qty + shipping + insurance;
      const fee = Math.round(subtotal * feeRate);
      const total = subtotal + fee - discount;

      $("resultBox").style.display = "block";
      $("total").textContent = `合計：${yen(total)}`;
      $("breakdown").textContent =
        `小計 ${yen(subtotal)} / 手数料 ${yen(fee)}（${Math.round(feeRate*100)}%） / 割引 ${yen(discount)}`;
    }

    $("calcBtn").addEventListener("click", calc);

    // 入力するたびに自動計算したい場合はこれを有効化
    ["itemPrice","qty","shipping","feeRate","insurance","discount"].forEach(id => {
      $(id).addEventListener("input", () => {
        // 必要なら未入力時は結果非表示など調整
        // ここでは常に再計算
        calc();
      });
    });
  </script>
</body>
</html>
